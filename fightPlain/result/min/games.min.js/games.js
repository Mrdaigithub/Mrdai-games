"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var a=0;a<e.length;a++){var s=e[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,a,s){return a&&t(e.prototype,a),s&&t(e,s),e}}();!function(t,e){var a=t,s=e,i=null,n=a.getElementById("canvas"),l=n.getContext("2d"),y=a.getElementById("startBtn"),r=a.getElementById("aboutBtn"),o=a.getElementById("welcome"),u=a.getElementById("pause"),h=!0;n.width=a.body.clientWidth,n.height=a.body.clientHeight,s.onresize=function(){n.width=a.body.clientWidth,n.height=a.body.clientHeight},r.addEventListener("touchstart",function(){alert("Mrdai倾情制作~")},!1),u.addEventListener("touchend",function(){h?(u.style.backgroundImage='url("img/Fav_Voice_Play-hd.png")',h=!1):(u.style.backgroundImage='url("img/Fav_Voice_Pause-hd.png")',h=!0)},!1);var d=function(){function t(e,a){var s=this;_classCallCheck(this,t),this.canvas=e,this.ctx=a,this.allScore=0,this.gameStatus=!1,this.gravityMode=!1,this.img=new Image,this.img.src="../img/gameArts.png",this.bg={speed:2,ready:!1,bg1:{x:0,y:0},bg2:{x:0,y:-568}},this.player={x:this.canvas.width/2,y:this.canvas.height-88,normalPos:[{x:432,y:332},{x:432,y:0}],diePos:[{x:432,y:250},{x:432,y:85},{x:432,y:168}],sX:null,sY:null,count:0,dieCount:0,dieStatus:!1,animationTime:200,animation:function(){s.dieStatus?setTimeout(function(){switch(i.player.dieCount){case 0:i.player.sX=i.player.diePos[0].x,i.player.sY=i.player.diePos[0].y,i.player.dieCount++;break;case 1:i.player.sX=i.player.diePos[1].x,i.player.sY=i.player.diePos[1].y,i.player.dieCount++;break;case 2:i.player.sX=i.player.diePos[2].x,i.player.sY=i.player.diePos[2].y,i.player.dieCount++}i.player.animation()},i.player.animationTime):setTimeout(function(){1===i.player.count?(i.player.count=0,i.player.sX=i.player.normalPos[0].x,i.player.sY=i.player.normalPos[0].y):(i.player.sX=i.player.normalPos[1].x,i.player.sY=i.player.normalPos[1].y,i.player.count++),i.player.animation()},i.player.animationTime)}},this.pos={x:this.canvas.width/2,y:this.canvas.height-33},this.bullet={speed:10,interval:100,power:10,dataPound:[{x:this.player.x,y:this.player.y,status:!1},{x:this.player.x,y:this.player.y,status:!1},{x:this.player.x,y:this.player.y,status:!1},{x:this.player.x,y:this.player.y,status:!1},{x:this.player.x,y:this.player.y,status:!1},{x:this.player.x,y:this.player.y,status:!1},{x:this.player.x,y:this.player.y,status:!1},{x:this.player.x,y:this.player.y,status:!1},{x:this.player.x,y:this.player.y,status:!1},{x:this.player.x,y:this.player.y,status:!1},{x:this.player.x,y:this.player.y,status:!1},{x:this.player.x,y:this.player.y,status:!1}],useBullet:function(){for(var t=0;t<this.dataPound.length;t++)if(!this.dataPound[t].status)return this.dataPound[t].status=!0,this.dataPound[t].x=i.player.x+33,setTimeout(function(){i.bullet.useBullet()},i.bullet.interval),this.dataPound[t]},moveBullet:function(){for(var t=0;t<this.dataPound.length;t++)this.dataPound[t].status&&(this.dataPound[t].y-=this.speed)},resetBullet:function(t){return this.dataPound[t].status=!1,this.dataPound[t].y=i.player.y,this.dataPound[t]}},this.enemy={simpleEnemy:{speed:6,hp:30,score:100,dataPound:[{x:0,y:0,status:!1}],diePos:[{x:50,y:658},{x:420,y:760},{x:470,y:750}],sX:82,sY:658,dieCount:0,animationTime:200,animation:function(){setTimeout(function(){switch(i.enemy.dieCount){case 0:i.enemy.dieCount++;break;case 1:i.enemy.dieCount++;break;case 2:i.enemy.dieCount++}i.enemy.animation()},i.enemy.animationTime)}}},i=this}return _createClass(t,[{key:"processUserInput",value:function(){var t=this;this.gravityMode||addEventListener("touchmove",function(e){var a=s.event||e;t.pos.x=a.targetTouches[0].clientX,t.pos.y=a.targetTouches[0].clientY},!1)}},{key:"loadImg",value:function(){var t=this;this.img.onload=function(){return t.bg.ready=!0}}},{key:"update",value:function(){this.bg.bg1.y>=568&&(this.bg.bg1.y=-568),this.bg.bg2.y>=568&&(this.bg.bg2.y=-568),this.bg.bg1.y+=this.bg.speed,this.bg.bg2.y+=this.bg.speed,this.player.x=this.pos.x-33,this.player.y=this.pos.y-55,this.bullet.moveBullet()}},{key:"render",value:function(){if(this.bg.ready){this.ctx.drawImage(this.img,0,0,320,568,this.bg.bg1.x,this.bg.bg1.y,this.canvas.width,this.canvas.height),this.ctx.drawImage(this.img,0,0,320,568,this.bg.bg2.x,this.bg.bg2.y,this.canvas.width,this.canvas.height),this.ctx.drawImage(this.img,this.player.sX,this.player.sY,64,80,this.player.x,this.player.y,64,80);for(var t=0;t<this.bullet.dataPound.length;t++)this.bullet.dataPound[t].status&&(this.bullet.dataPound[t].y<=0?this.bullet.resetBullet(t):this.ctx.drawImage(this.img,0,730,10,10,this.bullet.dataPound[t].x,this.bullet.dataPound[t].y,7,12));this.ctx.drawImage(this.img,this.enemy.simpleEnemy.sX,this.enemy.simpleEnemy.sY,32,22,this.enemy.simpleEnemy.dataPound[0].x+50,this.enemy.simpleEnemy.dataPound[0].y+50,30,22)}}},{key:"main",value:function(){i.update(),i.render(),requestAnimationFrame(function(){i.main()})}},{key:"start",value:function(){this.processUserInput(),this.loadImg(),this.player.animation(),this.bullet.useBullet(),this.main()}}]),t}(),p=function(t,e){return new d(t,e)};y.addEventListener("touchstart",function(){o.style.display="none",n.style.display="block",u.style.display="block";var t=p(n,l);t.start()},!1)}(document,window);